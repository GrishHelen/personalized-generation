# personalized-generation
## Курсовой проект по теме "Исследование методов персонализированной генерации с помощью диффузионных моделей", 3 курс (2024-25)

### Аннотация

Персонализированная генерация изображений — активно развивающееся направление в области компьютерного зрения, позволяющее создавать консистентные визуальные представления объектов в разнообразных сценах на основе текстовых описаний или референсных фотографий. Однако существующие методы сталкиваются с рядом ограничений: высокой вычислительной сложностью, снижением качества при работе со специфичными доменами и недостаточной гибкостью в адаптации к пользовательским запросам.

В данной работе было предложено избавиться от маскирования и использовать сингулярное разложение матриц механизма внимания для контроля над консистентностью объекта при генерации в различных сценах. Для нивелирования проблемы протекания фона было предложено несколько стратегий зануления младших сингулярных чисел. Также были реализованы и исследованы различные техники перевзвешивания сингулярных чисел для повышения визуального сходства объекта внутри батча. 

### Воспроизведение основных бейзлайнов

В качестве основного бейзлайна в данной работе рассматривается метод [Consistory](https://github.com/NVlabs/consistory.git). 

#### Примеры работы ConsiStory
В ходе проведенного исследования были проанализированы результаты бейзлайна. В частности, было отобрано 10 примеров успешной работы метода ConsiStory, демонстрирующих высокую степень согласованности внешнего вида объекта в различных сценах. Также были выявлены 10 случаев, в которых ConsiStory показал недостаточное качество. В этих примерах наблюдаются значительные расхождения во внешнем виде объекта на сгенерированных изображениях. Примеры хорошей и плохой работы редота представлены на рисунке ниже.

![Coursework_3year(кт-1)_page-0008](https://github.com/user-attachments/assets/3a570262-4721-4a21-a06f-b90b37a6d170)

Эксперименты показали, что метод как правило демонстрирует высокое качество при генерации изображений с животными (например, если объектом являются леопард или дельфин), сохраняя консистентность их визуальных особенностей между изображениями в различных сценах. Однако для неодушевленных объектов (автобус, коробка) зачастую наблюдается снижение стабильности: их внешний вид варьируется в зависимости от контекста.

#### Анализ недостатков бейзлайна и возможных улучшений метода

Одним из ключевых недостатков ConsiStory является зависимость его ключевого компонента (SDSA) от точности локализации объекта в изображении. В случае нетипичных объектов это может приводить к усилению расхождений во внешнем виде объектов. В данной работе предполагается преодолеть эту проблему и усовершенствовать метод, предложив другой способ модифицировать стандартный self-attention для повышения консистентности объекта на различных изображениях.
